<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    
    <title>Installation &mdash; IoT Site  documentation</title>
    <meta name="description" content="">
    <meta name="author" content="">

    

<link rel="stylesheet" href="_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" id="current-theme" href="_static/css/bootstrap3/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" id="current-adjust-theme" type="text/css" />

<link rel="stylesheet" href="_static/css/font-awesome.min.css">

<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
</style>

<link rel="stylesheet" href="_static/css/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    './',
            VERSION:     '',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
    <script type="text/javascript" src="_static/js/jquery.min.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/js/bootstrap3.min.js"></script>
<script type="text/javascript" src="_static/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="_static/js/basicstrap.js"></script>
<script type="text/javascript">
</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="IoT Site  documentation" href="index.html" />
    <link rel="next" title="Project Usage and Features" href="usage/index.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
  </head>
  <body role="document">
    <div id="navbar-top" class="navbar navbar-fixed-top navbar-default" role="navigation" aria-label="top navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">IoT Site  documentation</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
              <li class="dropdown visible-xs">
                <a role="button" id="localToc" data-toggle="dropdown" data-target="#" href="#">Table Of Contents <b class="caret"></b></a>
                <ul class="dropdown-menu localtoc sp-localtoc" role="menu" aria-labelledby="localToc">
                <ul>
<li><a class="reference internal" href="#">Installation</a><ul>
<li><a class="reference internal" href="#cloning-the-repository">Cloning the Repository</a></li>
<li><a class="reference internal" href="#docker-installation">Docker Installation</a></li>
<li><a class="reference internal" href="#manual-setup">Manual Setup</a><ul>
<li><a class="reference internal" href="#prerequisites-and-dependencies">Prerequisites and Dependencies</a></li>
<li><a class="reference internal" href="#setting-up-the-database">Setting up the Database</a><ul>
<li><a class="reference internal" href="#building-the-database">Building the Database</a></li>
<li><a class="reference internal" href="#populating-the-database">Populating the Database</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-backend">Running the Backend</a></li>
<li><a class="reference internal" href="#building-the-frontend">Building the Frontend</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                </ul>
              </li>

            
              <li><a href="introduction.html" title="Introduction" accesskey="P">previous </a></li>
              <li><a href="usage/index.html" title="Project Usage and Features" accesskey="N">next </a></li>
              <li><a href="genindex.html" title="General Index" accesskey="I">index </a></li>
            
            <li class="visible-xs"><a href="_sources/installation.rst.txt" rel="nofollow">Show Source</a></li>

            <li class="visible-xs">
                <form class="search form-search form-inline navbar-form navbar-right sp-searchbox" action="search.html" method="get">
                  <div class="input-append input-group">
                    <input type="text" class="search-query form-control" name="q" placeholder="Search...">
                    <span class="input-group-btn">
                    <input type="submit" class="btn" value="Go" />
                    </span>
                  </div>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </li>

            

          </ul>

        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container-fluid">

      <!-- row -->
      <div class="row">
         
<div class="col-md-3 hidden-xs" id="sidebar-wrapper">
  <div class="sidebar hidden-xs" role="navigation" aria-label="main navigation">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Installation</a><ul>
<li><a class="reference internal" href="#cloning-the-repository">Cloning the Repository</a></li>
<li><a class="reference internal" href="#docker-installation">Docker Installation</a></li>
<li><a class="reference internal" href="#manual-setup">Manual Setup</a><ul>
<li><a class="reference internal" href="#prerequisites-and-dependencies">Prerequisites and Dependencies</a></li>
<li><a class="reference internal" href="#setting-up-the-database">Setting up the Database</a><ul>
<li><a class="reference internal" href="#building-the-database">Building the Database</a></li>
<li><a class="reference internal" href="#populating-the-database">Populating the Database</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-backend">Running the Backend</a></li>
<li><a class="reference internal" href="#building-the-frontend">Building the Frontend</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="introduction.html"
                        title="previous chapter">Introduction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="usage/index.html"
                        title="next chapter">Project Usage and Features</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/installation.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" role="search">
  <h3>Quick search</h3>
  <form class="search form-inline" action="search.html" method="get">
      <div class="input-append input-group">
        <input type="text" class="search-query form-control" name="q" placeholder="Search...">
        <span class="input-group-btn">
        <input type="submit" class="btn" value="Go" />
        </span>
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div> 
        

        <div class="col-md-9" id="content-wrapper">
          <div class="document" role="main">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>Installation can be performed either using two methods. The two methods are as follows:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#docker-installation">Docker Installation</a></p></li>
<li><p><a class="reference internal" href="#manual-setup">Manual Setup</a></p></li>
</ul>
<p>The docker instance allows a user to get setup quickly on a new machine. The docker instance currently sets up the project in development mode. The manual setup is a bit more involved but allows for a more traditional development setup.</p>
<div class="section" id="cloning-the-repository">
<h2>Cloning the Repository<a class="headerlink" href="#cloning-the-repository" title="Permalink to this headline">¶</a></h2>
<p>Before starting the installation process, the user needs to first obtain the code. The code lives on GitHub and can be obtained <a class="reference external" href="https://github.com/Kanaderu/iotsite">here</a>. The repository can be downloaded using <cite>git</cite> or by download directly from the <a class="reference external" href="https://github.com/Kanaderu/iotsite/archive/master.zip">GitHub Project Page</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/Kanaderu/iotsite.git
</pre></div>
</div>
</div>
<div class="section" id="docker-installation">
<h2>Docker Installation<a class="headerlink" href="#docker-installation" title="Permalink to this headline">¶</a></h2>
<p>The Docker instance is described primarily by two main files, <strong>Dockerfile</strong> and <strong>docker-compose.yml</strong>. The <strong>Dockerfile</strong> file contains directives on how to compile a docker image for the current project. The <strong>docker-compose.yml</strong> file contains directives on how to orchestrate multiple docker images and how they interact with each other. The <strong>docker-compose.yml</strong> file pulls an image from <a class="reference external" href="https://hub.docker.com/">Docker-Hub</a>, an repository of Docker images, to instantiate a PostgreSQL database with PostGIS extensions for Geo support. The docker image will download all the required dependencies within its image.</p>
<p>To get the project setup with Docker, navigate to the location of the <strong>docker-compose.yml</strong> and run the following command. General Docker information can be found at the <a class="reference external" href="https://docs.docker.com/">Docker’s documentation</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose up
</pre></div>
</div>
<p>Note that the docker container may take a significant amount of time to initially setup the required dependencies and services. Once the docker containers are up and running, it can be viewed locally at <a class="reference external" href="http://localhost:8080">http://localhost:8080</a>. To change the default port, modify the ports in the <strong>docker-compose.yml</strong> file.</p>
</div>
<div class="section" id="manual-setup">
<h2>Manual Setup<a class="headerlink" href="#manual-setup" title="Permalink to this headline">¶</a></h2>
<p>The manual setup is a bit more involved requiring the developer to setup the dependencies for their system. This setup will document how to setup the project on an Ubuntu/Debian based machine. Dependencies and requirements may slightly differ from different flavors of Linux but the packages should not be dependent to a specific flavor of Linux.</p>
<p>A quick overview of the manual setup is below followed by details for each specific step.</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># install postgis support</span>
<span class="c1"># refer to https://postgis.net/install/ to install postgis for other distributions</span>
sudo apt-get install python-software-properties
sudo add-apt-repository ppa:ubuntugis/ppa
sudo apt-get update

<span class="c1"># install postgres database</span>
sudo apt-get install postgresql postgresql-contrib libpq-dev

<span class="c1"># install geospatial libraries</span>
sudo apt-get install binutils libproj-dev gdal-bin postgis

<span class="c1"># setup postgres with user &#39;geo&#39; with password &#39;geo&#39; and database &#39;geodjango&#39;</span>
sudo -u postgres psql -f utils/database/dev.sql

<span class="c1"># setup python</span>
pip install -r requirements                         <span class="c1"># install python libraries</span>

<span class="c1"># build database</span>
python manage.py makemigrations                     <span class="c1"># prepare database commands and check Django ORM</span>
python manage.py migrate                            <span class="c1"># build and commit database tables</span>

<span class="c1"># build react frontend</span>
python manage.py install_frontend_dependencies
python manage.py build_frontend

<span class="c1"># run server</span>
python manage.py runserver                          <span class="c1"># run the server locally</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="prerequisites-and-dependencies">
<h3>Prerequisites and Dependencies<a class="headerlink" href="#prerequisites-and-dependencies" title="Permalink to this headline">¶</a></h3>
<p>The main development libraries are as follows:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>Python &gt;= 3.5
PostgreSQL with PostGIS extensions
Node and NPM
</pre></div>
</div>
<p>To setup an python environment, it is recommended to either use <a class="reference external" href="https://virtualenv.pypa.io/en/latest/">virtualenv</a> or <a class="reference external" href="https://www.anaconda.com/distribution/">Anaconda</a>. The python environment will separate the development environment for this project from other python projects on your system. PostGIS and PostgreSQL are left to be installed which will vary based on the system the user is running. Refer to <a class="reference external" href="https://postgis.net/">PostGIS</a> to determine how to install PostGIS capabilities for other operating systems. After python has been installed, download the additional required programs by running the following commands:</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># install ppa for postgis</span>
sudo apt-get install python-software-properties
sudo add-apt-repository ppa:ubuntugis/ppa
sudo apt-get update

<span class="c1"># install postgres</span>
sudo apt-get install postgresql postgresql-contrib libpq-dev

<span class="c1"># install geospatial libraries</span>
sudo apt-get install binutils libproj-dev gdal-bin postgis
</pre></div>
</td></tr></table></div>
<p>Once the appropriate libraries have been installed, the python dependencies can be added. It’s recommended to first create a virtual environment as mentioned before. Install the python packages by running the following on the <cite>requirements.txt</cite> file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -r requirements.txt
</pre></div>
</div>
<p>The frontend is built with javascript and <a class="reference external" href="https://reactjs.org/">React</a>. Installation of node may vary from platform to platform so viewing the documentation and installation instructions specific to the target platform. Node and npm/yarn can be downloaded from the <a class="reference external" href="https://nodejs.org/en/download/">Node website</a> (the latest LTS is being used for stability).</p>
<p>Once node and npm/yarn have been setup, the frontend dependencies can be installed. Navigate to the frontend in <em>dashboard/</em> where <strong>package.json</strong> is located. <strong>package.json</strong> defines the frontend project. Run the following commands to download the dependencies:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>yarn
</pre></div>
</div>
<p>Alternatively, a Django management command is written in the <em>setup</em> app which does the same thing. To invoke this alternative, run the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py install_frontend_dependencies
</pre></div>
</div>
</div>
<div class="section" id="setting-up-the-database">
<h3>Setting up the Database<a class="headerlink" href="#setting-up-the-database" title="Permalink to this headline">¶</a></h3>
<p>The database first needs to be created before it can be populated. The first step involves building the database with a username and password. After a user has been created, a database is created specifically for the project and PostGIS extensions are enabled for the database.</p>
<p>Once the database has been setup properly, Django can begin populating the database with its appropriate ORM tables.</p>
<div class="section" id="building-the-database">
<h4>Building the Database<a class="headerlink" href="#building-the-database" title="Permalink to this headline">¶</a></h4>
<p>The database at this point is currently empty. To begin populating and setting up the database, a user will be created and a database table will be created with PostGIS extensions enabled. For convenience, a <cite>.sql</cite> script is available to create the user and database. To run the script run the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo -u postgres psql -f utils/database/dev.sql
</pre></div>
</div>
<p>The script can be examined. In summary, it will:</p>
<ul class="simple">
<li><p>Create a user named <strong>geo</strong> with password <strong>geo</strong></p></li>
<li><p>Create a database <strong>geodjango</strong></p></li>
<li><p>Enable PostGIS extensions for the <strong>geodjango</strong> database</p></li>
</ul>
<p>The database and user information is used for the project installation located in the project’s settings file (<em>iotsite/settings/dev.py</em>). A separate settings file (<em>iotsite/settings/production.py</em>) is used for a production environment and is highly recommended to change the default username/password/database for security reasons.</p>
</div>
<div class="section" id="populating-the-database">
<h4>Populating the Database<a class="headerlink" href="#populating-the-database" title="Permalink to this headline">¶</a></h4>
<p>Populating the database, once it’s been created can be done using Django’s <em>./manage.py</em> script. Populate the database by running the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py makemigrations
python manage.py migrate
</pre></div>
</div>
<p>Note that these two steps are required every time the Django ORM model has been modified. Specifically, the <em>makemigrations</em> directive specifies how the current instance of the database will be altered and <em>migrate</em> with commit those changes to the database. If code changes are not made to any ORM models (any <em>models.py</em> changes), then migrations to the database do not need to be made. Refer to the <a class="reference external" href="https://docs.djangoproject.com/">Django documentation</a> for additional details.</p>
</div>
</div>
<div class="section" id="running-the-backend">
<h3>Running the Backend<a class="headerlink" href="#running-the-backend" title="Permalink to this headline">¶</a></h3>
<p>Once the database has been built, the backend can be launched. To run the backend server, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py runserver <span class="m">8080</span>       <span class="c1"># optional port 8080 is specified, otherwise defaults to 8000</span>
</pre></div>
</div>
</div>
<div class="section" id="building-the-frontend">
<h3>Building the Frontend<a class="headerlink" href="#building-the-frontend" title="Permalink to this headline">¶</a></h3>
<p>At this point, viewing the website at <a class="reference external" href="http://localhost:8080">http://localhost:8080</a> does not show the frontend. This is particularly due to the frontend hasn’t been built. To build the frontend, navigate to the <cite>dashboard/</cite> app and run the following commands to build the frontend:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>yarn build
</pre></div>
</div>
<p>Alternatively, a Django management command is written in the <em>setup</em> app which does the same thing. To invoke this alternative, run the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python manage.py build_frontend
</pre></div>
</div>
<p>Once the frontend has been built, the backend is setup to automatically setup the routes to render it. The page at <a class="reference external" href="http://localhost:8080">http://localhost:8080</a> from before should now render the project.</p>
</div>
</div>
</div>


                </div>
              </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row footer-relbar">
<div id="navbar-related" class=" related navbar navbar-default" role="navigation" aria-label="related navigation">
  <div class="navbar-inner">
    <ul class="nav navbar-nav ">
        <li><a href="index.html">IoT Site  documentation</a></li>
    </ul>
<ul class="nav navbar-nav pull-right hidden-xs hidden-sm">
      
        <li><a href="introduction.html" title="Introduction" >previous</a></li>
        <li><a href="usage/index.html" title="Project Usage and Features" >next</a></li>
        <li><a href="genindex.html" title="General Index" >index</a></li>
        <li><a href="#">top</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer role="contentinfo">
          &copy; Copyright 2020, David Fan.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.4.4.
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>