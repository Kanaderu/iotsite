<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    
    <title>API Usage &mdash; IoT Site  documentation</title>
    <meta name="description" content="">
    <meta name="author" content="">

    

<link rel="stylesheet" href="../_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" id="current-theme" href="../_static/css/bootstrap3/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" id="current-adjust-theme" type="text/css" />

<link rel="stylesheet" href="../_static/css/font-awesome.min.css">

<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
</style>

<link rel="stylesheet" href="../_static/css/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '../',
            VERSION:     '',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
    <script type="text/javascript" src="../_static/js/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/js/bootstrap3.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="../_static/js/basicstrap.js"></script>
<script type="text/javascript">
</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="IoT Site  documentation" href="../index.html" />
    <link rel="up" title="Project Usage and Features" href="index.html" />
    <link rel="next" title="Developer Documentation" href="../development/index.html" />
    <link rel="prev" title="Project Usage and Features" href="index.html" /> 
  </head>
  <body role="document">
    <div id="navbar-top" class="navbar navbar-fixed-top navbar-default" role="navigation" aria-label="top navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">IoT Site  documentation</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
              <li class="dropdown visible-xs">
                <a role="button" id="localToc" data-toggle="dropdown" data-target="#" href="#">Table Of Contents <b class="caret"></b></a>
                <ul class="dropdown-menu localtoc sp-localtoc" role="menu" aria-labelledby="localToc">
                <ul>
<li><a class="reference internal" href="#">API Usage</a><ul>
<li><a class="reference internal" href="#user">User</a><ul>
<li><a class="reference internal" href="#registration-and-authentication">Registration and Authentication</a><ul>
<li><a class="reference internal" href="#registration">Registration</a></li>
<li><a class="reference internal" href="#login">Login</a></li>
<li><a class="reference internal" href="#verification">Verification</a></li>
<li><a class="reference internal" href="#refresh">Refresh</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api-for-publishing-sensor-data">API for Publishing Sensor Data</a><ul>
<li><a class="reference internal" href="#obtaining-an-api-token">Obtaining an API Token</a></li>
<li><a class="reference internal" href="#publishing-data-with-an-api-token">Publishing Data with an API Token</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

                </ul>
              </li>

            
              <li><a href="index.html" title="Project Usage and Features" accesskey="P">previous </a></li>
              <li><a href="../development/index.html" title="Developer Documentation" accesskey="N">next </a></li>
              <li><a href="../genindex.html" title="General Index" accesskey="I">index </a></li>
              <li><a href="index.html" accesskey="U">Project Usage and Features</a></li>
            
            <li class="visible-xs"><a href="../_sources/usage/api.rst.txt" rel="nofollow">Show Source</a></li>

            <li class="visible-xs">
                <form class="search form-search form-inline navbar-form navbar-right sp-searchbox" action="../search.html" method="get">
                  <div class="input-append input-group">
                    <input type="text" class="search-query form-control" name="q" placeholder="Search...">
                    <span class="input-group-btn">
                    <input type="submit" class="btn" value="Go" />
                    </span>
                  </div>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </li>

            

          </ul>

        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container-fluid">

      <!-- row -->
      <div class="row">
         
<div class="col-md-3 hidden-xs" id="sidebar-wrapper">
  <div class="sidebar hidden-xs" role="navigation" aria-label="main navigation">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">API Usage</a><ul>
<li><a class="reference internal" href="#user">User</a><ul>
<li><a class="reference internal" href="#registration-and-authentication">Registration and Authentication</a><ul>
<li><a class="reference internal" href="#registration">Registration</a></li>
<li><a class="reference internal" href="#login">Login</a></li>
<li><a class="reference internal" href="#verification">Verification</a></li>
<li><a class="reference internal" href="#refresh">Refresh</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api-for-publishing-sensor-data">API for Publishing Sensor Data</a><ul>
<li><a class="reference internal" href="#obtaining-an-api-token">Obtaining an API Token</a></li>
<li><a class="reference internal" href="#publishing-data-with-an-api-token">Publishing Data with an API Token</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Project Usage and Features</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../development/index.html"
                        title="next chapter">Developer Documentation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/usage/api.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" role="search">
  <h3>Quick search</h3>
  <form class="search form-inline" action="../search.html" method="get">
      <div class="input-append input-group">
        <input type="text" class="search-query form-control" name="q" placeholder="Search...">
        <span class="input-group-btn">
        <input type="submit" class="btn" value="Go" />
        </span>
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div> 
        

        <div class="col-md-9" id="content-wrapper">
          <div class="document" role="main">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <div class="section" id="api-usage">
<h1>API Usage<a class="headerlink" href="#api-usage" title="Permalink to this headline">¶</a></h1>
<p>The most up-to-date API usage can be found at <cite>/docs/</cite>. The following API shows how to use several of the endpoints for the backend and example <cite>curl</cite> calls to interact with the server.</p>
<div class="section" id="user">
<h2>User<a class="headerlink" href="#user" title="Permalink to this headline">¶</a></h2>
<p>Basic users can be added from the registration page on the frontend site. Users can alternatively interact with the REST API (which is what the frontend uses).</p>
<p>User login and resource access is based on the <cite>access</cite> and <cite>refresh</cite> strategy where both <cite>access</cite> and <cite>refresh</cite> tokens are used to verify the user. The <cite>access</cite> tokens are typically short-lived, expiring sooner,  and provide access to the server resources. The <cite>refresh</cite> tokens are a bit longer than the <cite>access</cite> tokens for their expiration date and are used to retrieve a new <cite>access</cite> token. The short-lived <cite>access</cite> token is setup for various security reasons, mainly if an attacker gets ahold of the token, the amount of time the attacker can use the token will be limited. Since both the <cite>access</cite> and <cite>refresh</cite> token can both expire, using the <a class="reference internal" href="#verification">Verification</a> API defined below can be used to check if a token is still valid. The <a class="reference internal" href="#refresh">Refresh</a> API is used to refresh user <cite>access</cite> tokens if the <cite>refresh</cite> token is still valid.</p>
<p>To use the access token, the REST call must contain the access token in the <cite>Header</cite> in the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Authorization</span><span class="p">:</span> <span class="n">Bearer</span> <span class="o">&lt;</span><span class="n">ACCESS_TOKEN</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="section" id="registration-and-authentication">
<h3>Registration and Authentication<a class="headerlink" href="#registration-and-authentication" title="Permalink to this headline">¶</a></h3>
<p>JSON Web Tokens (JWT) are used for authentication for user login and user actions. To login and perform actions the user must first register an account. The details to do so are listed below. To find out more information about JWT, read <a class="reference external" href="https://jwt.io/introduction/">here</a> and find the <a class="reference external" href="https://tools.ietf.org/rfc/rfc7519.txt">standard located here</a>.</p>
<div class="section" id="registration">
<h4>Registration<a class="headerlink" href="#registration" title="Permalink to this headline">¶</a></h4>
<p>To register users, send data to <cite>/api/register/</cite>.</p>
<p>The following POST format is used to register users.</p>
<div class="highlight-json notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;user1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;password1&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="login">
<h4>Login<a class="headerlink" href="#login" title="Permalink to this headline">¶</a></h4>
<p>To login users, send data to <cite>/api/login/</cite> which will return an <cite>access</cite> and <cite>refresh</cite> token if the user is valid.</p>
<p>The following POST format is used to login users.</p>
<div class="highlight-json notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;user1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;password1&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>A valid response will return the following format:</p>
<div class="highlight-json notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;refresh&quot;</span><span class="p">:</span> <span class="s2">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTU3NDEyNDg0NywianRpIjoiMDhiYjQxYTQ4ZWVhNDE4YWEzOTEwZWU1YWMxYjY2ZjciLCJ1c2VyX2lkIjoyfQ.cg7NQ8YwVbuX2mVEGg6AFkNVQc7PEs72ohDiOnr2ZPg&quot;</span><span class="p">,</span>
    <span class="nt">&quot;access&quot;</span><span class="p">:</span> <span class="s2">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNTc0MDM4NzQ3LCJqdGkiOiIxYzk4NTM2MGQ3NDA0OWFiYmZkNDQzMDliYjAyMzhkMCIsInVzZXJfaWQiOjJ9.Uz_X2sECClBkfT7p1GyCI8L9buJNVvJ2gxq0VJOBqaM&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="verification">
<h4>Verification<a class="headerlink" href="#verification" title="Permalink to this headline">¶</a></h4>
<p>Verfication is used to ensure that the provided token is still valid. The verification endpoint is located at <cite>/api/verify/</cite> which will return a <cite>200</cite> response if the provided token is valid.</p>
<p>The following POST format is used for token verification:</p>
<div class="highlight-json notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;token&quot;</span><span class="p">:</span><span class="s2">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNTczODg2ODQ0LCJqdGkiOiI5ZjI3MzQxZDIyNGQ0YWIwODRmM2YwYTZmYmNlNWQ4YSIsInVzZXJfaWQiOjJ9.wq9C-a1wJDojXUDGo73fhxQylWVgtmOYNhtEl0Up052&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="refresh">
<h4>Refresh<a class="headerlink" href="#refresh" title="Permalink to this headline">¶</a></h4>
<p>The Refresh API is used to obtain a new <cite>access</cite> token using a valid <cite>refresh</cite> token. A new valid <cite>access</cite> token will be provided from a valid refresh request.</p>
<p>The following POST format is used for refreshing a token:</p>
<div class="highlight-json notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;refresh&quot;</span><span class="p">:</span> <span class="s2">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTU3NDEyNDg0NywianRpIjoiMDhiYjQxYTQ4ZWVhNDE4YWEzOTEwZWU1YWMxYjY2ZjciLCJ1c2VyX2lkIjoyfQ.cg7NQ8YwVbuX2mVEGg6AFkNVQc7PEs72ohDiOnr2ZPg&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>A valid response will return the following format:</p>
<div class="highlight-json notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;access&quot;</span><span class="p">:</span> <span class="s2">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNTc0MDM4NzY2LCJqdGkiOiJiNTZjYjJjNmZjMzc0OWRlYTZiYmJjYjJhZTM0ZjBjMCIsInVzZXJfaWQiOjJ9.9kKnf0QY1mM41mA-D0Ixl30yofOC78qU-fePWB6WnMM&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="api-for-publishing-sensor-data">
<h3>API for Publishing Sensor Data<a class="headerlink" href="#api-for-publishing-sensor-data" title="Permalink to this headline">¶</a></h3>
<p>Data on the backend will vary in which information will be private and public. Publishing data will additionally require the user to first obtain an API token in order to access and push up new data. The API token is to be used for publishing sensor data instead of the access token.</p>
<p>To use the access token, the REST call must contain the access token in the <cite>Header</cite> in the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Authorization</span><span class="p">:</span> <span class="n">Bearer</span> <span class="o">&lt;</span><span class="n">API_TOKEN</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="section" id="obtaining-an-api-token">
<h4>Obtaining an API Token<a class="headerlink" href="#obtaining-an-api-token" title="Permalink to this headline">¶</a></h4>
<p>Obtaining an API token is done by requesting an API token from the endpoint located at <cite>/api/token/</cite> which will provide an API token for publishing sensor data.</p>
</div>
<div class="section" id="publishing-data-with-an-api-token">
<h4>Publishing Data with an API Token<a class="headerlink" href="#publishing-data-with-an-api-token" title="Permalink to this headline">¶</a></h4>
<p>Once an API token has been obtained, sensor data can be published to their respective endpoints.</p>
<p>An example curl command can be used, with a valid API token, as follows:</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span>curl -X POST <span class="se">\</span>
-H <span class="s2">&quot;Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNTc0MDM4NzY2LCJqdGkiOiJiNTZjYjJjNmZjMzc0OWRlYTZiYmJjYjJhZTM0ZjBjMCIsInVzZXJfaWQiOjJ9.9kKnf0QY1mM41mA-D0Ixl30yofOC78qU-fePWB6WnMM&quot;</span> <span class="se">\</span>
-H <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="se">\</span>
-d <span class="s1">&#39;{</span>
<span class="s1">        &quot;dev_id&quot;: 1,</span>
<span class="s1">        &quot;metadata&quot;: {</span>
<span class="s1">              &quot;location&quot;: &quot;Apartment&quot;,</span>
<span class="s1">              &quot;latitude&quot;: 39.77710000,</span>
<span class="s1">              &quot;longitude&quot;: -83.99720000,</span>
<span class="s1">              &quot;time&quot;: &quot;2019-10-02T19:17:10.067889-04:00&quot;</span>
<span class="s1">        },</span>
<span class="s1">        &quot;data&quot;: [</span>
<span class="s1">         {</span>
<span class="s1">             &quot;sensor_id&quot;: 1,</span>
<span class="s1">             &quot;sensor_type&quot;: &quot;Temperature&quot;,</span>
<span class="s1">             &quot;sensor_data&quot;: 19.813,</span>
<span class="s1">             &quot;sensor_units&quot;: &quot;C&quot;</span>
<span class="s1">         },</span>
<span class="s1">         {</span>
<span class="s1">             &quot;sensor_id&quot;: 2,</span>
<span class="s1">             &quot;sensor_type&quot;: &quot;Temperature&quot;,</span>
<span class="s1">             &quot;sensor_data&quot;: 16.188,</span>
<span class="s1">             &quot;sensor_units&quot;: &quot;C&quot;</span>
<span class="s1">         }</span>
<span class="s1">         ]</span>
<span class="s1">    }&#39;</span> <span class="se">\</span>
http://localhost:8080/api/Feather/
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>
</div>


                </div>
              </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row footer-relbar">
<div id="navbar-related" class=" related navbar navbar-default" role="navigation" aria-label="related navigation">
  <div class="navbar-inner">
    <ul class="nav navbar-nav ">
        <li><a href="../index.html">IoT Site  documentation</a></li>
    </ul>
<ul class="nav navbar-nav pull-right hidden-xs hidden-sm">
      
        <li><a href="index.html" title="Project Usage and Features" >previous</a></li>
        <li><a href="../development/index.html" title="Developer Documentation" >next</a></li>
        <li><a href="../genindex.html" title="General Index" >index</a></li>
        <li><a href="index.html" >Project Usage and Features</a></li>
        <li><a href="#">top</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer role="contentinfo">
          &copy; Copyright 2020, David Fan.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.0.3.
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>